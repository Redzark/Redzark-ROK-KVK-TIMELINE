<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RoK KVK 1689 CENTER</title>
<style>
    /* === ê¸°ë³¸ ìŠ¤íƒ€ì¼ === */
    body { background-color: #121212; color: #e0e0e0; font-family: sans-serif; margin: 0; padding: 10px; text-align: center; }
    h1 { color: #ffb74d; font-size: 1.4rem; margin: 5px 0; }
    .sub { color: #888; font-size: 0.9rem; margin-bottom: 15px; }
    
    /* ì‹œê³„ */
    #clock-box { background: #1e1e1e; border: 1px solid #333; padding: 8px 15px; border-radius: 20px; display: inline-block; margin-bottom: 10px; font-family: monospace; line-height: 1.4; color: #ccc; font-size: 0.85rem; }

    .wrap { max-width: 720px; margin: 0 auto; text-align: left; }
    
    /* === 1. ì™¸êµ (ë§¨ ìœ„) === */
    .diplomacy-section { background: #1e1e1e; border: 1px solid #333; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
    .diplo-grid { display: flex; flex-wrap: wrap; gap: 10px; }
    .diplo-col { flex: 1; min-width: 280px; }
    .diplo-head { font-weight: bold; margin-bottom: 8px; display: block; font-size: 0.95rem; border-bottom: 1px solid #444; padding-bottom: 5px;}
    
    /* === 2. ì „ìˆ  ì§€ë„ (Map) === */
    .map-container {
        position: relative; width: 100%; padding-bottom: 100%; /* 1:1 ë¹„ìœ¨ ì •ì‚¬ê°í˜• */
        background: #0f1519; border-radius: 12px; border: 2px solid #444;
        margin-bottom: 15px; overflow: hidden;
        box-shadow: inset 0 0 50px #000;
    }
    
    /* ì§€í˜• ê·¸ë¦¬ê¸° (CSSë¡œ êµ¬í˜„í•œ ë§µ) */
    .zone-1 { /* ì™¸ê³½ */
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background: radial-gradient(circle, transparent 60%, #1a2634 61%);
        opacity: 0.5; pointer-events: none;
    }
    .zone-2 { /* ì¤‘ê°„ */
        position: absolute; top: 20%; left: 20%; right: 20%; bottom: 20%;
        border: 2px dashed #555; border-radius: 50%;
        pointer-events: none; opacity: 0.3;
    }
    .kingsland { /* ì¤‘ì•™ í‚¹ìŠ¤ëœë“œ */
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 18%; height: 18%; background: rgba(255, 0, 0, 0.1);
        border: 2px solid #d32f2f; border-radius: 15%;
        display: flex; align-items: center; justify-content: center;
        color: #ef5350; font-weight: bold; font-size: 0.8rem; text-align: center;
        box-shadow: 0 0 15px rgba(239, 83, 80, 0.2);
    }

    /* ë§µ í•€ (Pins) */
    .pin {
        position: absolute; transform: translate(-50%, -50%);
        display: flex; flex-direction: column; align-items: center;
        z-index: 10; cursor: default; width: 100px;
    }
    /* í•€ ì•„ì´ì½˜ */
    .pin-icon {
        width: 12px; height: 12px; border-radius: 50%; 
        border: 2px solid #fff; box-shadow: 0 0 5px #000;
        margin-bottom: 4px;
    }
    /* í•€ ë¼ë²¨ */
    .pin-label {
        background: rgba(0, 0, 0, 0.8); border-radius: 4px; padding: 4px 8px;
        text-align: center; border: 1px solid #555; backdrop-filter: blur(2px);
    }
    .pin-name { font-size: 0.8rem; font-weight: bold; display: block; margin-bottom: 2px; }
    .pin-server { font-size: 0.7rem; color: #ccc; white-space: nowrap; }

    /* ì•„êµ° ìŠ¤íƒ€ì¼ */
    .ally .pin-icon { background: #66bb6a; box-shadow: 0 0 10px #66bb6a; }
    .ally .pin-label { border-color: #66bb6a; }
    .ally .pin-name { color: #66bb6a; }

    /* ì êµ° ìŠ¤íƒ€ì¼ */
    .enemy .pin-icon { background: #ef5350; box-shadow: 0 0 10px #ef5350; }
    .enemy .pin-label { border-color: #ef5350; }
    .enemy .pin-name { color: #ef5350; }

    /* === ìœ„ì¹˜ ì¢Œí‘œ (ê³„ì±…ì˜ í­í’ 6ê°œ ì§„ì˜ ì‹¤ì œ ìœ„ì¹˜) === */
    /* ì‹œê³„ ë°©í–¥: ë¶ˆ(12) -> ëŒ€ì§€(2) -> ë°”ëŒ(4) -> ë¬¼(6) -> ìˆ²(8) -> ì—¬ëª…(10) */
    .pos-fire  { top: 12%; left: 50%; }  /* 12ì‹œ */
    .pos-earth { top: 25%; left: 82%; }  /* 2ì‹œ */
    .pos-wind  { top: 75%; left: 82%; }  /* 4ì‹œ */
    .pos-water { top: 88%; left: 50%; }  /* 6ì‹œ */
    .pos-green { top: 75%; left: 18%; }  /* 8ì‹œ */
    .pos-day   { top: 25%; left: 18%; }  /* 10ì‹œ */

    /* íƒœê·¸ ë””ìì¸ */
    .tag { display: inline-block; padding: 3px 8px; border-radius: 4px; font-size: 0.8rem; margin: 2px; color: #fff; font-weight: bold; text-shadow: 1px 1px 1px rgba(0,0,0,0.5); }
    .bg-day { background: linear-gradient(135deg, #fbc02d, #f57f17); color:#000; text-shadow:none;} 
    .bg-green { background: linear-gradient(135deg, #43a047, #2e7d32); }
    .bg-water { background: linear-gradient(135deg, #1e88e5, #1565c0); }
    .bg-fire { background: linear-gradient(135deg, #e53935, #c62828); }
    .bg-earth { background: linear-gradient(135deg, #795548, #4e342e); }
    .bg-wind { background: linear-gradient(135deg, #00897b, #00695c); }

    /* ê¸°íƒ€ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
    .sec-box { border: 1px solid #333; border-radius: 8px; background: #1e1e1e; margin-bottom: 10px; overflow: hidden; }
    .sec-header { padding: 12px; background: #252525; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; }
    .sec-body { display: none; padding: 10px; border-top: 1px solid #333; }
    .sec-body.open { display: block; }
    
    .card-t { font-weight: bold; border-bottom: 1px solid #444; padding-bottom: 5px; margin-bottom: 8px; display: block; font-size: 1rem; }
    .c-gold { color: #ffb74d; } .c-green { color: #66bb6a; } .c-red { color: #ef5350; }

    /* íƒ€ì´ë¨¸ & ë¦¬ìŠ¤íŠ¸ */
    .t-box { background: #121212; border: 1px solid #333; padding: 10px; text-align: center; border-radius: 6px; margin-bottom: 10px; }
    .t-big { font-size: 1.4rem; font-weight: bold; font-family: monospace; color: #fff; display: block; margin-top: 5px; }
    .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #2a2a2a; font-size: 0.9rem; }
    .row.active { background: rgba(255, 183, 77, 0.1); }
    .r-right { text-align: right; font-family: monospace; color: #888; font-size: 0.8rem; }
    .badge { background: #ffb74d; color: #000; padding: 1px 4px; border-radius: 3px; font-size: 0.7rem; margin-left: 5px; font-weight: bold; }
    .btn-copy { background: none; border: 1px solid #555; color: #aaa; font-size: 0.7rem; margin-left: 5px; cursor: pointer; }

    @media (max-width: 600px) {
        .diplo-grid { flex-direction: column; }
    }
</style>
</head>
<body>

    <h1>KVK 1689 CENTER</h1>
    <div class="sub">Storm of Stratagems (ê³„ì±…ì˜ í­í’)</div>
    <div id="clock-box">Loading...</div>

    <div class="wrap">
        
        <div class="diplomacy-section">
            <span class="card-t c-green">ğŸ¤ Diplomacy (ì™¸êµ)</span>
            <div class="diplo-grid">
                <div class="diplo-col">
                    <span class="diplo-head" style="color:#66bb6a">ğŸ”µ Allies (ì•„êµ°)</span>
                    <span class="tag bg-day">â˜€ï¸ Daybreak (1689, 2334)</span>
                    <span class="tag bg-green">ğŸŒ² Greenwood (3155, 2238)</span>
                    <span class="tag bg-water">ğŸ’§ Water (1206, 3530)</span>
                </div>
                <div class="diplo-col">
                    <span class="diplo-head" style="color:#ef5350">ğŸ”´ Enemies (ì êµ°)</span>
                    <span class="tag bg-fire">ğŸ”¥ Fire (1393, 3253)</span>
                    <span class="tag bg-earth">â›°ï¸ Earth (2877, 2620)</span>
                    <span class="tag bg-wind">ğŸƒ Wind (1486, 1305)</span>
                </div>
            </div>
        </div>

        <div class="map-container">
            <div class="zone-1"></div>
            <div class="zone-2"></div>
            <div class="kingsland">KING'S<br>LAND</div>

            <div class="pin ally pos-day">
                <div class="pin-icon"></div>
                <div class="pin-label"><span class="pin-name">Daybreak</span><span class="pin-server">1689, 2334</span></div>
            </div>
            <div class="pin ally pos-green">
                <div class="pin-icon"></div>
                <div class="pin-label"><span class="pin-name">Greenwood</span><span class="pin-server">3155, 2238</span></div>
            </div>
            <div class="pin ally pos-water">
                <div class="pin-icon"></div>
                <div class="pin-label"><span class="pin-name">Water</span><span class="pin-server">1206, 3530</span></div>
            </div>

            <div class="pin enemy pos-fire">
                <div class="pin-icon"></div>
                <div class="pin-label"><span class="pin-name">Fire</span><span class="pin-server">1393, 3253</span></div>
            </div>
            <div class="pin enemy pos-earth">
                <div class="pin-icon"></div>
                <div class="pin-label"><span class="pin-name">Earth</span><span class="pin-server">2877, 2620</span></div>
            </div>
            <div class="pin enemy pos-wind">
                <div class="pin-icon"></div>
                <div class="pin-label"><span class="pin-name">Wind</span><span class="pin-server">1486, 1305</span></div>
            </div>
        </div>

        <div class="sec-box" style="padding:12px">
            <span class="card-t c-gold">ğŸ“¢ Notice (ê³µì§€)</span>
            <ul style="padding-left:20px; margin:0; font-size:0.9rem; color:#ccc;">
                <li>âš”ï¸ Goal: 3ì²œë§Œ í‚¬ (30M Kills)</li>
                <li>ğŸšœ Farming: ììœ  (Free)</li>
                <li>â›” City Hit: ê¸ˆì§€ (No Zeroing)</li>
            </ul>
        </div>

        <div class="sec-box">
            <div class="sec-header" style="border-left:4px solid #ef5350" onclick="toggle('s1')">
                <span>ğŸš© Milestones (ì£¼ìš”ì¼ì •)</span><span>â–¼</span>
            </div>
            <div id="s1" class="sec-body open">
                <div id="tb-ms" class="t-box" style="display:none">
                    <span id="tt-ms" style="color:#ffb74d; font-weight:bold">-</span>
                    <span id="td-ms" class="t-big">00:00:00</span>
                </div>
                <div id="lst-ms">Loading...</div>
            </div>
        </div>

        <div class="sec-box">
            <div class="sec-header" style="border-left:4px solid #42a5f5" onclick="toggle('s2')">
                <span>ğŸ›ï¸ Ruins (ê³ ëŒ€ìœ ì )</span><span>â–¼</span>
            </div>
            <div id="s2" class="sec-body">
                <div id="tb-ru" class="t-box" style="display:none">
                    <span id="tt-ru" style="color:#42a5f5; font-weight:bold">-</span>
                    <span id="td-ru" class="t-big">00:00:00</span>
                </div>
                <div id="lst-ru">Loading...</div>
            </div>
        </div>

        <div class="sec-box">
            <div class="sec-header" style="border-left:4px solid #ab47bc" onclick="toggle('s3')">
                <span>ğŸ”¥ Altar (ì–´ë‘ ì œë‹¨)</span><span>â–¼</span>
            </div>
            <div id="s3" class="sec-body">
                <div id="tb-al" class="t-box" style="display:none">
                    <span id="tt-al" style="color:#ab47bc; font-weight:bold">-</span>
                    <span id="td-al" class="t-big">00:00:00</span>
                </div>
                <div id="lst-al">Loading...</div>
            </div>
        </div>

    </div>

    <script>
    // ===== ì•ˆì „ì¥ì¹˜ =====
    try {
        // ë‚ ì§œ ìƒì„± (KST ê¸°ì¤€, ì •ìˆ˜ ì…ë ¥)
        // Date.UTC(ë…„, ì›”-1, ì¼, ì‹œ-9, ë¶„)
        function getKSTTime(y, m, d, h, min) {
            return Date.UTC(y, m-1, d, h-9, min, 0);
        }

        // ===== ë°ì´í„° ì„¤ì • =====
        var DATA = {
            ms: [
                { k:"4ê´€ë¬¸ ì˜¤í”ˆ", e:"Gate 4", t: getKSTTime(2025,12,14, 0,10) },
                { k:"5ê´€ë¬¸ ì˜¤í”ˆ", e:"Gate 5", t: getKSTTime(2025,12,18, 0,10) },
                { k:"6ê´€ë¬¸ ì˜¤í”ˆ", e:"Gate 6", t: getKSTTime(2025,12,20, 0,10) },
                { k:"í‚¹ìŠ¤ëœë“œ", e:"Kingsland", t: 0 },
                { k:"KVK ì¢…ë£Œ", e:"End", t: 0 }
            ],
            ruins: { start: getKSTTime(2025,12,11, 0,10), gap: 40, cnt: 28 },
            altar: { start: getKSTTime(2025,12,22, 0,10), gap: 86, cnt: 10 }
        };

        var TARGETS = { ms:0, ru:0, al:0 };

        // ===== ìœ í‹¸ í•¨ìˆ˜ =====
        function pad(n) { return n<10 ? "0"+n : n; }

        function fmtTime(ts) {
            if(ts === 0) return "TBA (ì¶”í›„ì•ˆë‚´)";
            var d = new Date(ts + (9*3600000));
            var u = new Date(ts);
            var kst = d.getUTCFullYear() + "." + pad(d.getUTCMonth()+1) + "." + pad(d.getUTCDate()) + " " + pad(d.getUTCHours()) + ":" + pad(d.getUTCMinutes());
            var utc = pad(u.getUTCHours()) + ":" + pad(u.getUTCMinutes());
            return "ğŸ‡°ğŸ‡· " + kst + "<br>ğŸŒ UTC " + utc;
        }

        function makeList(cfg, nk, ne) {
            var arr = [];
            var now = new Date().getTime();
            var st = cfg.start;
            for(var i=0; i<cfg.cnt; i++) {
                var t = st + (i * cfg.gap * 3600000);
                if(t > now - 7200000) {
                    arr.push({ k: nk + " ("+(i+1)+")", e: ne + " #"+(i+1), t: t });
                }
            }
            return arr;
        }

        function draw(key, list) {
            var el = document.getElementById("lst-" + key);
            var box = document.getElementById("tb-" + key);
            var tit = document.getElementById("tt-" + key);

            if(list.length === 0) { el.innerHTML = "End."; return; }

            var next = null;
            for(var i=0; i<list.length; i++) {
                if(list[i].t > 0) { next = list[i]; break; }
            }

            if(next) {
                TARGETS[key] = next.t;
                box.style.display = "block";
                tit.innerHTML = next.k;
            }

            var h = "";
            for(var j=0; j<list.length; j++) {
                var item = list[j];
                var isNext = (item === next);
                var cls = isNext ? "row active" : "row";
                var badge = isNext ? "<span class='badge'>NEXT</span>" : "";
                h += "<div class='"+cls+"'><div><b>"+item.k+"</b>"+badge+"<div style='font-size:0.8rem;color:#888'>"+item.e+"</div></div><div class='r-right'>"+fmtTime(item.t)+"</div></div>";
            }
            el.innerHTML = h;
        }

        // ===== ì‹¤í–‰ =====
        function init() {
            draw("ms", DATA.ms);
            draw("ru", makeList(DATA.ruins, "ê³ ëŒ€ìœ ì ", "Ruins"));
            draw("al", makeList(DATA.altar, "ì–´ë‘ ì œë‹¨", "Altar"));
            setInterval(tick, 1000);
            tick();
        }

        function tick() {
            var now = new Date();
            var nowTs = now.getTime();
            var kstD = new Date(nowTs + (9*3600000));
            var ks = kstD.getUTCFullYear()+"-"+pad(kstD.getUTCMonth()+1)+"-"+pad(kstD.getUTCDate())+" "+pad(kstD.getUTCHours())+":"+pad(kstD.getUTCMinutes())+":"+pad(kstD.getUTCSeconds());
            var us = pad(now.getUTCHours())+":"+pad(now.getUTCMinutes())+":"+pad(now.getUTCSeconds());
            document.getElementById("clock-box").innerHTML = "ğŸ‡°ğŸ‡· " + ks + " (KST) | ğŸŒ " + us + " (UTC)";

            updTimer("ms", nowTs);
            updTimer("ru", nowTs);
            updTimer("al", nowTs);
        }

        function updTimer(key, nowTs) {
            var t = TARGETS[key];
            var el = document.getElementById("td-" + key);
            if(!t || t===0) return;
            var diff = t - nowTs;
            if(diff <= 0) {
                el.innerHTML = "OPEN NOW!";
                el.style.color = "#00e676";
            } else {
                var s = Math.floor((diff/1000)%60);
                var m = Math.floor((diff/60000)%60);
                var h = Math.floor((diff/3600000)%24);
                var d = Math.floor(diff/86400000);
                el.innerHTML = d + "d " + pad(h) + ":" + pad(m) + ":" + pad(s);
                el.style.color = "#fff";
            }
        }

        window.toggle = function(id) {
            var el = document.getElementById(id);
            if(el.style.display === "block") el.style.display = "none";
            else el.style.display = "block";
        };

        init();

    } catch(e) {
        document.body.innerHTML += "<div style='color:red;'>Error: "+e.message+"</div>";
    }
    </script>
</body>
</html>
