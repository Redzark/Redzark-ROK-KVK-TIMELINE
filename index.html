<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KVK 1689 FINAL MAP</title>
<style>
    /* === ê¸°ë³¸ === */
    body { background-color: #0f1215; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; text-align: center; }
    
    /* ì‹œê³„ */
    #clock { 
        background: #1e2328; border: 1px solid #444; padding: 6px 15px; border-radius: 20px; 
        display: inline-block; margin-bottom: 15px; font-family: monospace; font-size: 0.9rem; color: #bbb;
    }

    .wrap { max-width: 700px; margin: 0 auto; text-align: left; }

    /* === ì™¸êµ === */
    .card { background: #1e2328; border: 1px solid #333; border-radius: 8px; padding: 12px; margin-bottom: 15px; }
    .card-t { font-weight: bold; border-bottom: 1px solid #444; padding-bottom: 6px; margin-bottom: 10px; color: #66bb6a; display: block;}
    
    .diplo-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.85rem; }
    .tag { display: inline-block; padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; color: #fff; font-weight: bold; border: 1px solid rgba(255,255,255,0.2); }

    /* === [í•µì‹¬] ë¦¬ì–¼ ë§µ (CSSë¡œ ëª¨ì–‘ ë‚´ê¸°) === */
    .map-box {
        position: relative; width: 100%; height: 380px; 
        background: #111; border: 2px solid #444; border-radius: 12px; 
        margin-bottom: 20px; overflow: hidden; 
        box-shadow: inset 0 0 50px #000;
    }

    /* ë§µ ë°°ê²½ íŒ¨í„´ */
    .map-bg {
        position: absolute; width: 100%; height: 100%; opacity: 0.3;
        background-image: radial-gradient(#333 1px, transparent 1px); background-size: 20px 20px;
    }

    /* ì§€í˜• ê³µí†µ */
    .zone { 
        position: absolute; display: flex; flex-direction: column; 
        align-items: center; justify-content: center; text-align: center;
        color: #fff; text-shadow: 1px 1px 2px #000; z-index: 2;
        transition: 0.2s;
    }
    .zone:hover { z-index: 10; filter: brightness(1.2); }
    .z-name { font-weight: bold; font-size: 0.9rem; }
    .z-svr { font-size: 0.7rem; opacity: 0.8; font-family: monospace; background: rgba(0,0,0,0.5); padding: 1px 4px; border-radius: 4px; }

    /* --- [ëª¨ì–‘ ë§Œë“¤ê¸° (Clip-path)] --- */
    
    /* 1. ì êµ° (ìœ„ìª½) */
    .fire { 
        top: 2%; left: 2%; width: 32%; height: 40%; 
        background: linear-gradient(135deg, #b71c1c, #5f0808); border: 2px solid #ef5350;
        clip-path: polygon(0 0, 100% 0, 100% 70%, 70% 100%, 0 100%);
    }
    .earth { 
        top: 2%; left: 34%; width: 32%; height: 40%; 
        background: linear-gradient(135deg, #e65100, #bf360c); border: 2px solid #ffab91;
        clip-path: polygon(0 0, 100% 0, 100% 70%, 80% 100%, 20% 100%, 0 70%);
    }
    .wind { 
        top: 2%; right: 2%; width: 32%; height: 40%; 
        background: linear-gradient(135deg, #4a148c, #311b92); border: 2px solid #b39ddb;
        clip-path: polygon(0 0, 100% 0, 100% 100%, 30% 100%, 0 70%);
    }

    /* 2. ì•„êµ° (ì•„ë˜ìª½) */
    .day { 
        bottom: 2%; left: 2%; width: 32%; height: 40%; 
        background: linear-gradient(135deg, #f57f17, #ef6c00); border: 2px solid #ffca28; color:#fff;
        clip-path: polygon(0 0, 70% 0, 100% 30%, 100% 100%, 0 100%);
    }
    .green { 
        bottom: 2%; left: 34%; width: 32%; height: 40%; 
        background: linear-gradient(135deg, #2e7d32, #1b5e20); border: 2px solid #66bb6a;
        clip-path: polygon(20% 0, 80% 0, 100% 30%, 100% 100%, 0 100%, 0 30%);
    }
    .water { 
        bottom: 2%; right: 2%; width: 32%; height: 40%; 
        background: linear-gradient(135deg, #0277bd, #01579b); border: 2px solid #42a5f5;
        clip-path: polygon(30% 0, 100% 0, 100% 100%, 0 100%, 0 30%);
    }

    /* 3. í‚¹ìŠ¤ëœë“œ (ì¤‘ì•™) */
    .kingsland {
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 30%; height: 25%; z-index: 1;
        background: rgba(239, 83, 80, 0.15); border: 2px dashed #ef5350; border-radius: 12px;
        display: flex; align-items: center; justify-content: center;
        color: #ef5350; font-weight: bold; font-size: 0.9rem;
    }

    /* === ê³µì§€ & ë¦¬ìŠ¤íŠ¸ === */
    .sec-h { padding: 10px 15px; background: #2c323a; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; border-left: 4px solid #666; border-radius: 6px; margin-bottom: 5px; }
    .sec-b { display: none; padding: 10px; background: #1a1a1a; border-radius: 6px; border: 1px solid #333; margin-bottom: 10px; }
    .sec-b.on { display: block; }

    .t-box { background: #111; padding: 8px; text-align: center; border: 1px solid #333; border-radius: 6px; margin-bottom: 5px; display: none; }
    .t-val { font-size: 1.3rem; font-weight: bold; font-family: monospace; color: #fff; }
    
    .row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #333; font-size: 0.85rem; }
    .row.active { background: rgba(102, 187, 106, 0.15); border-left: 3px solid #66bb6a; }
    .copy-btn { background: #333; border: 1px solid #555; color: #ccc; font-size: 0.7rem; cursor: pointer; border-radius: 3px; margin-left: 8px; }
</style>
</head>
<body>

    <h1>KVK 1689 WAR ROOM</h1>
    <div class="sub">Storm of Stratagems (ê³„ì±…ì˜ í­í’)</div>
    <div id="clock">Loading...</div>

    <div class="wrap">
        
        <div class="card">
            <span class="card-t">ğŸ¤ Diplomacy</span>
            <div class="diplo-row">
                <span style="color:#66bb6a; font-weight:bold;">ğŸ”µ ì•„êµ° (Allies)</span>
                <div>
                    <span class="tag" style="background:#fbc02d; color:#000">Daybreak</span>
                    <span class="tag" style="background:#43a047">Greenwood</span>
                    <span class="tag" style="background:#0277bd">Water</span>
                </div>
            </div>
            <div class="diplo-row">
                <span style="color:#ef5350; font-weight:bold;">ğŸ”´ ì êµ° (Enemies)</span>
                <div>
                    <span class="tag" style="background:#c62828">Fire</span>
                    <span class="tag" style="background:#ef6c00">Earth</span>
                    <span class="tag" style="background:#7b1fa2">Wind</span>
                </div>
            </div>
        </div>

        <div class="map-box">
            <div class="map-bg"></div>
            
            <div class="kingsland">KING'S LAND</div>

            <div class="zone fire">
                <div class="z-name">ğŸ”¥ FIRE</div><div class="z-svr">1393, 3253</div>
            </div>
            <div class="zone earth">
                <div class="z-name">â›°ï¸ EARTH</div><div class="z-svr">2877, 2620</div>
            </div>
            <div class="zone wind">
                <div class="z-name">ğŸƒ WIND</div><div class="z-svr">1486, 1305</div>
            </div>

            <div class="zone day">
                <div class="z-name">â˜€ï¸ DAYBREAK</div><div class="z-svr" style="color:#222; background:rgba(255,255,255,0.7)">1689, 2334</div>
            </div>
            <div class="zone green">
                <div class="z-name">ğŸŒ² GREENWOOD</div><div class="z-svr">3155, 2238</div>
            </div>
            <div class="zone water">
                <div class="z-name">ğŸ’§ WATER</div><div class="z-svr">1206, 3530</div>
            </div>
        </div>

        <div class="card" style="border-color:#ffb74d">
            <span class="card-t" style="color:#ffb74d; border:none; margin:0">ğŸ“¢ Notice</span>
            <ul style="padding-left:20px; margin:5px 0 0 0; font-size:0.85rem; color:#ccc;">
                <li>âš”ï¸ Goal: 3ì²œë§Œ í‚¬ (30M Kills)</li>
                <li>ğŸšœ Farming: ììœ  (Free)</li>
                <li>â›” City Hit: ê¸ˆì§€ (No Zeroing)</li>
            </ul>
        </div>

        <div class="sec-head" style="border-left:4px solid #ef5350" onclick="toggle('s1')">
            <span>ğŸš© Milestones (ì£¼ìš”ì¼ì •)</span><span>â–¼</span>
        </div>
        <div id="s1" class="sec-b on">
            <div id="t-ms" class="t-box">
                <span id="tt-ms" style="color:#ffb74d; font-weight:bold">-</span>
                <span id="td-ms" class="t-val">00:00:00</span>
                <button class="copy-btn" onclick="copy('ms')">COPY</button>
            </div>
            <div id="l-ms"></div>
        </div>

        <div class="sec-head" style="border-left:4px solid #42a5f5; margin-top:5px" onclick="toggle('s2')">
            <span>ğŸ›ï¸ Ruins (ê³ ëŒ€ìœ ì )</span><span>â–¼</span>
        </div>
        <div id="s2" class="sec-b">
            <div id="t-ru" class="t-box">
                <span id="tt-ru" style="color:#42a5f5; font-weight:bold">-</span>
                <span id="td-ru" class="t-val">00:00:00</span>
                <button class="copy-btn" onclick="copy('ru')">COPY</button>
            </div>
            <div id="l-ru"></div>
        </div>

        <div class="sec-head" style="border-left:4px solid #ab47bc; margin-top:5px" onclick="toggle('s3')">
            <span>ğŸ”¥ Altar (ì–´ë‘ ì œë‹¨)</span><span>â–¼</span>
        </div>
        <div id="s3" class="sec-b">
            <div id="t-al" class="t-box">
                <span id="tt-al" style="color:#ab47bc; font-weight:bold">-</span>
                <span id="td-al" class="t-val">00:00:00</span>
                <button class="copy-btn" onclick="copy('al')">COPY</button>
            </div>
            <div id="l-al"></div>
        </div>

    </div>

    <script>
    // ===== ì•ˆì „ ìŠ¤í¬ë¦½íŠ¸ =====
    try {
        function kst(y,m,d,h,min) { return Date.UTC(y, m-1, d, h-9, min, 0); }

        var DATA = {
            ms: [
                {k:"4ê´€ë¬¸ ì˜¤í”ˆ", e:"Gate 4", t: kst(2025,12,14, 0,10)},
                {k:"5ê´€ë¬¸ ì˜¤í”ˆ", e:"Gate 5", t: kst(2025,12,18, 0,10)},
                {k:"6ê´€ë¬¸ ì˜¤í”ˆ", e:"Gate 6", t: kst(2025,12,20, 0,10)},
                {k:"í‚¹ìŠ¤ëœë“œ", e:"Kingsland", t: 0},
                {k:"KVK ì¢…ë£Œ", e:"End", t: 0}
            ],
            ruins: { start: kst(2025,12,11, 0,10), gap: 40, cnt: 28 },
            altar: { start: kst(2025,12,22, 0,10), gap: 86, cnt: 10 }
        };

        var TARGETS = { ms:0, ru:0, al:0 };

        function pad(n) { return n<10 ? "0"+n : n; }
        function fmt(ts) {
            if(ts === 0) return "TBA";
            var d = new Date(ts + 9*3600000);
            return "ğŸ‡°ğŸ‡· "+d.getUTCMonth()+1+"/"+d.getUTCDate()+" "+pad(d.getUTCHours())+":"+pad(d.getUTCMinutes());
        }

        function makeList(cfg, k, e) {
            var arr = [];
            var now = new Date().getTime();
            for(var i=0; i<cfg.cnt; i++) {
                var t = cfg.start + (i * cfg.gap * 3600000);
                if(t > now - 7200000) arr.push({k: k+" ("+(i+1)+")", e: e+" #"+(i+1), t:t});
            }
            return arr;
        }

        function draw(key, arr) {
            var el = document.getElementById("l-"+key);
            if(arr.length === 0) { el.innerHTML = "ì¢…ë£Œ"; return; }
            
            var next = null;
            for(var i=0; i<arr.length; i++) { if(arr[i].t > 0) { next = arr[i]; break; } }
            TARGETS[key] = next ? next.t : 0;

            if(next) {
                document.getElementById("t-"+key).style.display = "block";
                document.getElementById("tt-"+key).innerHTML = next.k;
            }

            var h = "";
            for(var j=0; j<arr.length; j++) {
                var it = arr[j];
                var cls = (it===next) ? "row active" : "row";
                var bdg = (it===next) ? "<span class='badge'>NEXT</span>" : "";
                h += "<div class='"+cls+"'><div><b>"+it.k+"</b>"+bdg+"</div><div class='r-right'>"+fmt(it.t)+"</div></div>";
            }
            el.innerHTML = h;
        }

        function tick() {
            var now = new Date().getTime();
            var k = new Date(now + 9*3600000);
            var ks = k.getUTCFullYear()+"-"+pad(k.getUTCMonth()+1)+"-"+pad(k.getUTCDate())+" "+pad(k.getUTCHours())+":"+pad(k.getUTCMinutes())+":"+pad(k.getUTCSeconds());
            document.getElementById("clock").innerText = "ğŸ‡°ğŸ‡· " + ks + " (KST)";

            upd("ms", now); upd("ru", now); upd("al", now);
        }

        function upd(key, now) {
            var t = TARGETS[key];
            var el = document.getElementById("td-"+key);
            if(!t || t===0) return;
            var d = t - now;
            if(d<=0) { el.innerHTML = "OPEN!"; el.style.color="#00e676"; }
            else {
                var h = Math.floor(d/3600000);
                var m = Math.floor((d%3600000)/60000);
                var s = Math.floor((d%60000)/1000);
                el.innerHTML = h + ":" + pad(m) + ":" + pad(s);
                el.style.color="#fff";
            }
        }

        window.toggle = function(id) {
            var el = document.getElementById(id);
            el.style.display = (el.style.display==="block") ? "none" : "block";
        }
        
        window.copy = function(key) {
            var t = document.getElementById("tt-"+key).innerText;
            var time = document.getElementById("td-"+key).innerText;
            prompt("Copy:", t + " : " + time);
        }

        draw("ms", DATA.ms);
        draw("ru", makeList(DATA.ruins, "ê³ ëŒ€ìœ ì ", "Ruins"));
        draw("al", makeList(DATA.altar, "ì–´ë‘ ì œë‹¨", "Altar"));
        setInterval(tick, 1000);
        tick();

    } catch(e) { document.body.innerText = "Error: " + e.message; }
    </script>
</body>
</html>
