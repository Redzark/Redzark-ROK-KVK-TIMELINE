<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1689ì„œë²„ KvK ì¼ì • ë° íƒ€ì´ë¨¸</title>
    <style>
        /* CSS ìŠ¤íƒ€ì¼ ì‹œì‘ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a2e;
            color: #ffffff;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        h1 {
            color: #ff3859;
            margin-bottom: 5px;
            font-size: 2em;
        }
        h2 {
            color: #b0b0b0;
            font-size: 1.2em;
            margin-bottom: 25px;
        }
        /* --- ë‹¬ë ¥ ìŠ¤íƒ€ì¼ --- */
        #calendar-container {
            background-color: #2a2a4a;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            padding: 20px;
            overflow-x: auto;
            margin-bottom: 40px;
        }
        .calendar {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        .calendar th {
            background-color: #33395b;
            color: #ffcc00;
            padding: 10px 0;
            font-size: 1.1em;
            border: 1px solid #3a3a5a;
        }
        .calendar td {
            height: 100px;
            border: 1px solid #3a3a5a;
            padding: 5px;
            vertical-align: top;
            text-align: left;
        }
        .day-number {
            font-size: 1.5em;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            color: #fff;
        }
        .sunday { color: #ff5757; }
        .saturday { color: #8af7a0; }
        .today {
            background-color: #4CAF50 !important;
            color: #fff;
            border: 3px solid #ffcc00;
        }
        .event-label {
            font-size: 0.75em;
            display: block;
            padding: 2px 4px;
            margin-top: 2px;
            border-radius: 3px;
            line-height: 1.2;
            font-weight: 500;
            text-align: center;
        }
        .event-phase { background-color: #555; color: #fff; }
        .event-major { background-color: #ff8c00; color: #fff; }

        /* --- ì¹´ìš´íŠ¸ë‹¤ìš´ ìŠ¤íƒ€ì¼ --- */
        .section-title {
            color: #ffcc00;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 2px solid #33395b;
            padding-bottom: 5px;
        }
        .event-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        .event-card {
            background-color: #2a2a4a;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .countdown {
            font-size: 2.5em;
            font-weight: 700;
            color: #4CAF50;
            letter-spacing: 2px;
            margin-top: 10px;
        }
        .cycle-info {
            font-size: 0.9em;
            color: #ff8c00; 
            font-weight: 600;
            margin-top: 5px;
        }
        /* CSS ìŠ¤íƒ€ì¼ ë */
    </style>
</head>
<body>
    <div class="container">
        <h1>1689ì„œë²„ ì‹ ê¸°ë¬˜ì‚° KVK íƒ€ì„ë¼ì¸</h1> 
        <h2>2025ë…„ 12ì›” KvK ì „ì²´ ì¼ì •</h2>
        
        <div id="calendar-container">
            <table class="calendar" id="kvk-calendar">
                <thead>
                    <tr>
                        <th>ì›”</th><th>í™”</th><th>ìˆ˜</th><th>ëª©</th><th>ê¸ˆ</th><th>í† </th><th class="sunday">ì¼</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>

        <div class="section-title">ğŸ•’ íí—ˆ/ì œë‹¨ ì‹¤ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´</div>
        <div class="event-grid" id="countdown-grid-recurring">
            </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // ----------------------------------------------------
            // [1] ì „ì—­ ìƒìˆ˜ ë° ë°ì´í„° ì„¤ì •
            // ----------------------------------------------------
            const KST_OFFSET = ":00 +09:00"; 
            const KVK_YEAR = '2025'; // ì—°ë„ ê³ ì •
            const TARGET_MONTH = 11; // 12ì›” (0ë¶€í„° ì‹œì‘)
            const TARGET_YEAR = 2025;

            // 1-A. ë°˜ë³µ ì´ë²¤íŠ¸ ëª©ë¡ (ì¹´ìš´íŠ¸ë‹¤ìš´ìš©)
            const RECURRING_EVENTS = [
                ["íí—ˆ", "2025-12-11 00:10", 40, 28], 
                ["ì œë‹¨", "2025-12-22 00:10", 86, 10], 
            ];
            
            // 1-B. ì—°ëŒ€ê¸° ì „ì²´ ëª©ë¡ (ë‹¬ë ¥ìš©)
            const KVK_EVENTS = [
                ["2025-12-05", "ì²«ê±¸ìŒ ì‹œì‘", "Phase"],
                ["2025-12-06", "ì›ì •êµ° ì£¼ë‘”ì§€ ê°œë°©", "Fixed"],
                ["2025-12-07", "ëˆˆì—ëŠ” ëˆˆ ì‹œì‘", "Phase"],
                ["2025-12-08", "ì§„ì˜ ìš”ìƒˆ ê°œë°©", "Fixed"],
                ["2025-12-08", "ìš”ì§€ì˜ ì „ìŸ ì‹œì‘", "Phase"], 
                ["2025-12-10", "í˜‘ë ¥ ì‹œì‘", "Phase"],
                ["2025-12-11", "íí—ˆ ì˜¤í”ˆ ì‹œì‘", "Major"], 
                ["2025-12-11", "ì§•ë²Œ ì‹œì‘", "Phase"],
                ["2025-12-13", "ë³µìˆ˜ ì‹œì‘", "Phase"],
                ["2025-12-14", "4ê´€ë¬¸ ì¼ë¶€ ê°œë°©", "Pass"], 
                ["2025-12-14", "ë¨¹êµ¬ë¦„ ì‹œì‘", "Phase"],
                ["2025-12-15", "ëŠ‘ëŒ€ì™€ ì™• ì‹œì‘", "Phase"],
                ["2025-12-16", "ì‹ ì „ ê°œë°©", "Fixed"],
                ["2025-12-17", "ìˆœë¡€ ì‹œì‘", "Phase"],
                ["2025-12-18", "5ê´€ë¬¸ ì¼ë¶€ ê°œë°©", "Pass"], 
                ["2025-12-18", "ì „ì§„ ì‹œì‘", "Phase"],
                ["2025-12-19", "ì„±ì „ ê°œë°©", "Fixed"],
                ["2025-12-19", "ì„±ì „ ì ë ¹ ì‹œì‘", "Phase"],
                ["2025-12-20", "6ê´€ë¬¸ ì¼ë¶€ ê°œë°©", "Pass"], 
                ["2025-12-21", "ì ‘ì „ í—ˆê°€ ì‹œì‘", "Phase"],
                ["2025-12-22", "ì œë‹¨ ì˜¤í”ˆ ì‹œì‘", "Major"], 
                ["2025-12-22", "í¬ìƒì ì‹œì‘", "Phase"],
                ["2025-12-24", "ê°ˆë“±ê³¼ ë¶„ìŸ ì‹œì‘", "Phase"],
                ["2025-12-26", "ë‹¨í•©ì˜ ì¥ ì‹œì‘ (KvK ì¢…ë£Œ)", "Phase"] 
            ];

            const CALENDAR_TABLE = document.getElementById('kvk-calendar').getElementsByTagName('tbody')[0];
            const TODAY = new Date();
            const CURRENT_YEAR = TODAY.getFullYear();
            const CURRENT_MONTH = TODAY.getMonth(); 
            
            // ----------------------------------------------------
            // [2] ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
            // ----------------------------------------------------
            function parseDate(dateStr) {
                let dateToParse = dateStr;
                if (dateStr.length < 11) { 
                    dateToParse = KVK_YEAR + "-" + dateStr;
                }
                return new Date(dateToParse + KST_OFFSET);
            }

            function formatTimeRemaining(ms) {
                if (ms < 0) return `<span class="passed">ì´ë¯¸ ì‹œì‘ë¨</span>`;
                
                const days = Math.floor(ms / (1000 * 60 * 60 * 24));
                const hours = Math.floor((ms % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((ms % (1000 * 60)) / 1000);
                
                const format = (n) => String(n).padStart(2, '0');
                
                if (days > 0) {
                    return `${days}ì¼ ${format(hours)}:${format(minutes)}:${format(seconds)}`;
                } else {
                    return `${format(hours)}:${format(minutes)}:${format(seconds)}`;
                }
            }


            // ----------------------------------------------------
            // [3] ë‹¬ë ¥ ìƒì„± ë¡œì§
            // ----------------------------------------------------
            function buildCalendar(year, month) {
                const date = new Date(year, month, 1);
                let monthStartsOn = date.getDay(); 
                if (monthStartsOn === 0) monthStartsOn = 7; 
                
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                let dayCounter = 1;
                
                CALENDAR_TABLE.innerHTML = ''; 

                for (let week = 0; week < 6; week++) {
                    const row = CALENDAR_TABLE.insertRow();
                    if (dayCounter > daysInMonth) break; 

                    for (let dayOfWeek = 0; dayOfWeek < 7; dayOfWeek++) {
                        const cell = row.insertCell();
                        
                        if (week === 0 && dayOfWeek < monthStartsOn - 1) {
                            cell.innerHTML = '';
                            cell.style.backgroundColor = '#1f1f38';
                            cell.style.border = 'none';
                            continue;
                        }
                        
                        if (dayCounter <= daysInMonth) {
                            cell.innerHTML = `<span class="day-number">${dayCounter}</span>`;
                            
                            const checkDate = new Date(year, month, dayCounter);
                            const isToday = checkDate.getDate() === TODAY.getDate() && 
                                            checkDate.getMonth() === CURRENT_MONTH && 
                                            checkDate.getFullYear() === CURRENT_YEAR;

                            if (isToday) { cell.classList.add('today'); }
                            if (dayOfWeek === 5) { cell.classList.add('saturday'); } 
                            if (dayOfWeek === 6) { cell.classList.add('sunday'); } 

                            insertEventsToCell(cell, year, month, dayCounter);

                            dayCounter++;
                        } else {
                            cell.innerHTML = '';
                            cell.style.backgroundColor = '#1f1f38';
                            cell.style.border = 'none';
                        }
                    }
                }
            }
            
            function insertEventsToCell(cell, year, month, day) {
                const searchDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                const eventsOnDay = KVK_EVENTS.filter(event => event[0] === searchDate);

                eventsOnDay.forEach(event => {
                    const [date, title, type] = event;
                    let className = '';
                    
                    if (type === 'Pass' || type === 'Major') {
                        className = 'event-major';
                    } else if (type === 'Fixed') {
                        className = 'event-pass';
                    } else {
                        className = 'event-phase';
                    }

                    cell.innerHTML += `<span class="event-label ${className}">${title.replace(' ì‹œì‘', '').replace(' (KvK ì¢…ë£Œ)', '')}</span>`;
                });
            }


            // ----------------------------------------------------
            // [4] ì¹´ìš´íŠ¸ë‹¤ìš´ ë¡œì§
            // ----------------------------------------------------
            function updateRecurringEvents(currentTime) {
                const gridRecurring = document.getElementById('countdown-grid-recurring');
                let htmlContent = '';

                RECURRING_EVENTS.forEach(([title, startTimeStr, recurrenceHours, totalCycles], index) => {
                    let nextTime = parseDate(startTimeStr);
                    const recurrenceMs = recurrenceHours * 60 * 60 * 1000;
                    let cycle = 0;
                    
                    while (nextTime.getTime() < currentTime.getTime()) {
                        nextTime = new Date(nextTime.getTime() + recurrenceMs);
                        cycle++;
                    }
                    
                    const timeDifference = nextTime.getTime() - currentTime.getTime();
                    const cycleNumber = cycle + 1;
                    let cycleInfo = `[ ${cycleNumber}íšŒì°¨ / ì´ ${totalCycles}íšŒ ]`;
                    
                    if (cycleNumber > totalCycles) {
                        cycleInfo = `[ ëª¨ë“  íšŒì°¨ ì™„ë£Œ ]`;
                        htmlContent += `
                            <div class="event-card">
                                <div class="event-title">${title}</div>
                                <div class="cycle-info">${cycleInfo}</div>
                                <div class="countdown passed">ì¢…ë£Œë¨</div>
                                <div class="next-time"></div>
                            </div>
                        `;
                        return; 
                    }

                    const countdownHTML = `<div class="countdown">${formatTimeRemaining(timeDifference)}</div>`;
                    
                    htmlContent += `
                        <div class="event-card">
                            <div class="event-title">${title}</div>
                            <div class="cycle-info">${cycleInfo}</div>
                            ${countdownHTML}
                            <div class="next-time">ë‹¤ìŒ ì˜¤í”ˆ: ${nextTime.toLocaleString('ko-KR', { 
                                month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: false 
                            }).replace('ì˜¤í›„', 'PM').replace('ì˜¤ì „', 'AM')}</div>
                        </div>
                    `;
                });
                gridRecurring.innerHTML = htmlContent;
            }


            // ----------------------------------------------------
            // [5] ë©”ì¸ ì‹¤í–‰ ë£¨í”„
            // ----------------------------------------------------
            function updateAll() {
                const currentTime = new Date();
                updateRecurringEvents(currentTime);
            }

            // ì´ˆê¸° ë‹¬ë ¥ ìƒì„± (12ì›”)
            buildCalendar(TARGET_YEAR, TARGET_MONTH); 
            
            // ì¹´ìš´íŠ¸ë‹¤ìš´ ì´ˆê¸° ì‹¤í–‰ ë° 1ì´ˆë§ˆë‹¤ ê°±ì‹ 
            updateAll();
            setInterval(updateAll, 1000); 
        });
    </script>
</body>
</html>
